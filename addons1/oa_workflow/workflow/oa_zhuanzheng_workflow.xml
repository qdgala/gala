<?xml version="1.0"?>
<openerp>
    <data noupdate="0">

        <!--定义工作流-->
        <record id="oa_zhuanzheng_workflow" model="workflow">
            <field name="name">转正申请</field>
            <field name="osv">oa.zhuanzheng</field>
            <field name="on_create">True</field>
        </record>
        <!--活动（Activity）定义-->
        <record id="activity_oa_zhuanzheng_sq" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="flow_start">True</field>
            <field name="name">试用期人员申请</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('sq')</field>
        </record>
        <record id="activity_oa_zhuanzheng_xzb" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="name">行政部审批</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('xzb')</field>
        </record>
        <record id="activity_oa_zhuanzheng_ldsp" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="name">直接上级领导审批</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('ldsp')</field>
        </record>
        <record id="activity_oa_zhuanzheng_fzsp" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="name">副总审批</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('fzsp')</field>
        </record>
        <record id="activity_oa_zhuanzheng_zjlsp" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="name">总经理审批</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('zjlsp')</field>
        </record>
        <record id="activity_oa_zhuanzheng_rszyqr" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="name">人事专员确认</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('rszyqr')</field>
        </record>
        <record id="activity_oa_zhuanzheng_ok" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="flow_stop">True</field>
            <field name="name">完成</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('ok')</field>
        </record>
        <record id="activity_oa_zhuanzheng_off" model="workflow.activity">
            <field name="wkf_id" ref="oa_zhuanzheng_workflow"/>
            <field name="flow_stop">True</field>
            <field name="name">关闭</field>
            <field name="kind">function</field>
            <field name="action">wkf_change_and_notice('off')</field>
        </record>

        <!--迁移（Transition）的定义-->
        <record id="trans_oa_zhuanzheng_sq_off" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_sq"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_off"/>
            <field name="signal">sq_off</field>
            <field name="condition">is_user()</field>
        </record>
        <record id="trans_oa_zhuanzheng_sq_xzb" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_sq"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_xzb"/>
            <field name="signal">sq_xzb</field>
            <field name="condition">is_user() and not emp_is_xzb_user()</field>
        </record>
        <record id="trans_oa_zhuanzheng_sq_ldsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_sq"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="signal">sq_xzb</field>
            <field name="condition">is_user() and emp_is_xzb_user()</field>
        </record>
        <record id="trans_oa_zhuanzheng_xzb_ldsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_xzb"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="signal">xzb_ldsp</field>
            <field name="condition">True</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_xzb"/>
        </record>
        <record id="trans_oa_zhuanzheng_ldsp_fzsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_fzsp"/>
            <field name="signal">ldsp_to</field>
            <field name="condition">is_ld() and not emp_is_cwb_user() and is_not_in(['oa_workflow.group_oa_department_fz','oa_workflow.group_oa_department_boss'])</field>
        </record>
        <record id="trans_oa_zhuanzheng_ldsp_zjlsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_zjlsp"/>
            <field name="signal">ldsp_to</field>
            <field name="condition">is_ld() and is_not_in(['oa_workflow.group_oa_department_boss'])</field>
        </record>
        <record id="trans_oa_zhuanzheng_ldsp_rszyqr" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_rszyqr"/>
            <field name="signal">ldsp_to</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
        </record>

        <record id="trans_oa_zhuanzheng_fzsp_zjlsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_fzsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_zjlsp"/>
            <field name="signal">fzsp_zjlsp</field>
            <field name="condition">is_fz()</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_fz"/>
        </record>
        <record id="trans_oa_zhuanzheng_zjlsp_rszyqr" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_zjlsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_rszyqr"/>
            <field name="signal">zjlsp_rszyqr</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
        </record>
        <record id="trans_oa_zhuanzheng_rszyqr_ok" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_rszyqr"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_ok"/>
            <field name="signal">rszyqr_ok</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_rszy"/>
        </record>
         <!--回退流程-->
        <record id="trans_oa_zhuanzheng_xzb_sq" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_xzb"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_sq"/>
            <field name="signal">xzb_sq</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_xzb"/>
        </record>
        <record id="trans_oa_zhuanzheng_ldsp_sq" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_sq"/>
            <field name="signal">ldsp_xzb</field>
            <field name="condition">is_ld() and emp_is_xzb_user()</field>
        </record>
        <record id="trans_oa_zhuanzheng_ldsp_xzb" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_xzb"/>
            <field name="signal">ldsp_xzb</field>
            <field name="condition">is_ld() and not emp_is_xzb_user()</field>
        </record>
        <record id="trans_oa_zhuanzheng_fzsp_ldsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_fzsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="signal">fzsp_back</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_fz"/>
        </record>
        <record id="trans_oa_zhuanzheng_zjlsp_ldsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_zjlsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_ldsp"/>
            <field name="signal">zjlsp_back</field>
            <field name="condition">emp_is_cwb_user() or emp_manager_is_fz()</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
        </record>
        <record id="trans_oa_zhuanzheng_zjlsp_fzsp" model="workflow.transition">
            <field name="act_from" ref="activity_oa_zhuanzheng_zjlsp"/>
            <field name="act_to" ref="activity_oa_zhuanzheng_fzsp"/>
            <field name="signal">zjlsp_back</field>
            <field name="condition">not emp_is_cwb_user() and not emp_manager_is_fz()</field>
            <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
        </record>


    </data>
</openerp>