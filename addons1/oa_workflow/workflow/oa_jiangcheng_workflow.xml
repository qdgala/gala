<?xml version="1.0"?>
<odoo>

    <!--定义工作流-->
    <record id="oa_jiangcheng_workflow" model="workflow">
        <field name="name">奖惩呈批表</field>
        <field name="osv">oa.jiangcheng</field>
        <field name="on_create">True</field>
    </record>
    <!--活动（Activity）定义-->
    <record id="activity_oa_jiangcheng_sq" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="flow_start">True</field>
        <field name="name">填报人申请</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('sq')</field>
    </record>
    <record id="activity_oa_jiangcheng_ldsp" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="name">上级领导审批</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('ldsp')</field>
    </record>
    <record id="activity_oa_jiangcheng_zjl" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="name">总经理审批</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('zjl')</field>
    </record>
    <record id="activity_oa_jiangcheng_xzb" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="name">行政部确认</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('xzb')</field>
    </record>
    <record id="activity_oa_jiangcheng_cwb" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="name">财务部</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('cwb')</field>
    </record>

    <record id="activity_oa_jiangcheng_ok" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="flow_stop">True</field>
        <field name="name">完成</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('ok')</field>
    </record>
    <record id="activity_oa_jiangcheng_off" model="workflow.activity">
        <field name="wkf_id" ref="oa_jiangcheng_workflow"/>
        <field name="flow_stop">True</field>
        <field name="name">关闭</field>
        <field name="kind">function</field>
        <field name="action">wkf_change_and_notice('off')</field>
    </record>

    <!--迁移（Transition）的定义-->
    <record id="trans_oa_jiangcheng_sq_off" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_sq"/>
        <field name="act_to" ref="activity_oa_jiangcheng_off"/>
        <field name="signal">sq_off</field>
        <field name="condition">is_tbr_or_create_user()</field>
    </record>
    <record id="trans_oa_jiangcheng_sq_ldsp" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_sq"/>
        <field name="act_to" ref="activity_oa_jiangcheng_ldsp"/>
        <field name="signal">sq_ldsp</field>
        <field name="condition">is_tbr_or_create_user() and not emp_is_zjl()</field>
    </record>
    <record id="trans_oa_jiangcheng_sq_xzb" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_sq"/>
        <field name="act_to" ref="activity_oa_jiangcheng_xzb"/>
        <field name="signal">sq_ldsp</field>
        <field name="condition">is_tbr_or_create_user()</field>
        <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
    </record>
    <record id="trans_oa_jiangcheng_ldsp_zjl" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_ldsp"/>
        <field name="act_to" ref="activity_oa_jiangcheng_zjl"/>
        <field name="signal">ldsp_zjl</field>
        <field name="condition">is_ld()</field>
    </record>
    <record id="trans_oa_jiangcheng_zjl_xzb" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_zjl"/>
        <field name="act_to" ref="activity_oa_jiangcheng_xzb"/>
        <field name="signal">zjl_xzb</field>
        <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
    </record>
    <record id="trans_oa_jiangcheng_xzb_cwb" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_xzb"/>
        <field name="act_to" ref="activity_oa_jiangcheng_cwb"/>
        <field name="signal">xzb_cwb</field>
        <field name="group_id" ref="oa_workflow.group_oa_department_xzb"/>
    </record>
    <record id="trans_oa_jiangcheng_cwb_ok" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_cwb"/>
        <field name="act_to" ref="activity_oa_jiangcheng_ok"/>
        <field name="signal">cwb_ok</field>
        <field name="group_id" ref="oa_workflow.group_oa_department_cwb"/>
    </record>

    <!--回退流程-->
    <record id="trans_oa_jiangcheng_ldsp_sq" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_ldsp"/>
        <field name="act_to" ref="activity_oa_jiangcheng_sq"/>
        <field name="signal">ldsp_sq</field>
        <field name="condition">is_ld()</field>
    </record>

    <record id="trans_oa_jiangcheng_zjl_ldsp" model="workflow.transition">
        <field name="act_from" ref="activity_oa_jiangcheng_zjl"/>
        <field name="act_to" ref="activity_oa_jiangcheng_ldsp"/>
        <field name="signal">zjl_ldsp</field>
        <field name="group_id" ref="oa_workflow.group_oa_department_boss"/>
    </record>

</odoo>