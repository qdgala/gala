<?xml version="1.0"?>
<openerp>
<data>
    <record id="purchase_apply_form" model="ir.ui.view">
            <field name="name">purchase.apply.form</field>
            <field name="model">purchase.apply</field>
            <field name="arch" type="xml">
                <form string="Purchase apply">
                <header>
                    <button name="button_confirm" type="object" states="draft" string="确认申请" id="draft_confirm"/>
                    <button name="button_confirm_fan" type="object" states="done" string="重置为草稿" id="draft_confirm_fan"/>
                    <button name="button_quxiao" type="object" states="done" string="取消申请" id="draft_quxiao"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,done,quxiao" readonly="1"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <label string="采购申请单"/>
                            <field name="name" class="oe_inline" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="create_uid"/>
                            <field name="create_date"/>
                            <field name="ly"/>
                        </group>
                        <group>
                            <field name="employee_id"/>
                            <field name="department_id"/>
                            <field name="employee_sh_id"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="申请明细">
                            <field name="order">
                                <tree string="Purchase apply Lines" editable="bottom">
                                    <field name="product_id"/>
                                    <field name="default_gys"/>
                                    <field name="product_qty"/>
                                    <field name="dhsj"/>
                                    <field name="state"/>
                                    <field name="purchase"/>
                                    <button type="object" name="open_this_rec" icon="gtk-index"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>

        <record id="view_purchase_apply_filter" model="ir.ui.view">
            <field name="name">purchase.apply.list.select</field>
            <field name="model">purchase.apply</field>
            <field name="arch" type="xml">
                <search string="Search Purchase apply">
                </search>
            </field>
        </record>

        <record id="purchase_apply_tree" model="ir.ui.view">
            <field name="name">purchase.apply.tree</field>
            <field name="model">purchase.apply</field>
            <field name="arch" type="xml">
                <tree  string="Purchase apply">
                    <field name="name" string="序号"/>
                </tree>
            </field>
        </record>

        <record id="purchase_apply" model="ir.actions.act_window">
            <field name="name">采购申请单</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.apply</field>
            <field name="context">{}</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_purchase_apply_filter"/>
        </record>

        <menuitem action="purchase_apply" id="menu_purchase_apply"
            parent="purchase.menu_procurement_management"
            sequence="0" name="采购申请单"/>

        <record id="seq_purchase_apply" model="ir.sequence">
            <field name="name">Purchase apply</field>
            <field name="code">purchase.apply</field>
            <field name="prefix">ap</field>
            <field name="padding">5</field>
            <field name="company_id" eval="False"/>
        </record>
    <!--采购申请明细-->

    <record id="view_purchase_apply_order_filter" model="ir.ui.view">
            <field name="name">purchase.apply.order.list.select</field>
            <field name="model">purchase.apply.order</field>
            <field name="arch" type="xml">
                <search string="Search Purchase apply">
                </search>
            </field>
        </record>

    <record id="purchase_apply_order_tree" model="ir.ui.view">
            <field name="name">purchase.apply.order.tree</field>
            <field name="model">purchase.apply.order</field>
            <field name="arch" type="xml">
                <tree  string="Purchase apply order">
                    <field name="apply"/>
                    <field name="apply_ly"/>
                    <field name="product_id"/>
                    <field name="default_gys"/>
                    <field name="product_qty"/>
                    <field name="dhsj"/>
                    <field name="state"/>
                    <field name="purchase"/>
                    <button type="object" name="open_this_rec" icon="gtk-index"/>
                </tree>
            </field>
        </record>

        <record id="win_purchase_apply_order" model="ir.actions.act_window">
            <field name="name">采购申请明细</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.apply.order</field>
            <field name="domain">[('apply_ly','=',False)]</field>
            <field name="context">{}</field>
            <field name="view_mode">tree</field>
            <field name="search_view_id" ref="view_purchase_apply_order_filter"/>
        </record>

        <menuitem action="win_purchase_apply_order" id="menu_purchase_apply_order"
            parent="purchase.menu_procurement_management"
            sequence="2" name="采购申请明细"/>
    <!--关联销售的采购申请明细-->

        <record id="win_purchase_apply_order_sale" model="ir.actions.act_window">
            <field name="name">采购申请明细</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.apply.order</field>
            <field name="context">{}</field>
            <field name="domain">[('apply_ly','!=',False)]</field>
            <field name="view_mode">tree</field>
            <field name="search_view_id" ref="view_purchase_apply_order_filter"/>
        </record>

        <menuitem action="win_purchase_apply_order_sale" id="menu_purchase_apply_order_sale"
            parent="purchase.menu_procurement_management"
            sequence="3" name="采购申请明细(销售生成)"/>
</data>
</openerp>
